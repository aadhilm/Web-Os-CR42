<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Linux Desktop Environment</title>
  
  <!-- Fonts and Icons -->
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,500,700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Styles -->
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Ubuntu', sans-serif;
      background-color: #3d3846;
      color: #ffffff;
      overflow: hidden;
      user-select: none;
      height: 100vh;
      background-image: url('https://images.unsplash.com/photo-1614624532983-4ce03382d63d');
      background-size: cover;
      background-position: center;
    }
    
    .disable-select {
      -webkit-user-select: none;  
      -moz-user-select: none;    
      -ms-user-select: none;      
      user-select: none;
    }
    
    /* Starting Screen */
    #starting-win {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #241f31;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    
    #starting-win img {
      width: 100px;
      margin-bottom: 20px;
    }
    
    .ring {
      position: relative;
      width: 100px;
      height: 100px;
    }
    
    .indeterminate-ring {
      position: absolute;
      width: 100%;
      height: 100%;
      border: 5px solid transparent;
      border-radius: 50%;
      animation: rotate 2s linear infinite;
    }
    
    .indicator-1 { border-top-color: #78aeed; }
    .indicator-2 { border-top-color: #78aeed; animation-delay: -0.5s; }
    .indicator-3 { border-top-color: #78aeed; animation-delay: -1s; }
    .indicator-4 { border-top-color: #78aeed; animation-delay: -1.5s; }
    .indicator-5 { border-top-color: #78aeed; animation-delay: -2s; }
    
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Loader */
    #loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9998;
    }
    
    /* Desktop Area */
    #main {
      position: absolute;
      top: 0;
      left: 0;
      width: calc(100% - 10px);
      height: calc(100% - 50px);
      padding: 5px;
      display: flex;
      flex-wrap: wrap;
      align-content: flex-start;
    }
    
    .desktop-item {
      width: 80px;
      margin: 10px;
      text-align: center;
      padding: 5px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .desktop-item:hover {
      background-color: rgba(120, 174, 237, 0.2);
    }
    
    .desktop-item img {
  width: 48px;
  height: 48px;
  filter: hue-rotate(190deg) saturate(1.5);
}
.desktop-item img.firefox-icon {
  filter: none !important;
}
    
    .icon-name {
      margin: 5px 0 0 0;
      font-size: 12px;
      color: #ffffff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }
    
    /* Panel (Linux-style taskbar) */
    #panel {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 40px;
      background-color: rgba(61, 56, 70, 0.9);
      display: flex;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .app-menu {
      padding: 0 15px;
      height: 100%;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    
    .app-menu:hover {
      background-color: rgba(120, 174, 237, 0.2);
    }
    
    .panel-icon {
      margin: 0 5px;
      padding: 5px;
      cursor: pointer;
    }
    
    .panel-icon:hover {
      background-color: rgba(120, 174, 237, 0.2);
      border-radius: 4px;
    }
    
    #system-tray {
      margin-left: auto;
      display: flex;
      align-items: center;
      padding-right: 15px;
    }
    
    #clock {
      font-family: 'Ubuntu Mono', monospace;
      color: #ffffff;
      padding: 0 10px;
    }
    
    /* Windows (Tabs) */
    .window {
      position: absolute;
      width: 800px;
      height: 500px;
      background-color: #f6f5f4;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      display: none;
      flex-direction: column;
      z-index: 100;
      overflow: hidden;
    }
    
    .tab-header {
      height: 40px;
      background-color: #3d3846;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 15px;
      font-weight: 500;
      cursor: move;
    }
    
    .tab-header i {
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
    }
    
    .tab-header i:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .tab-middle {
      flex: 1;
      background-color: #f6f5f4;
      overflow: auto;
      padding: 10px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 15px;
    }
    
    .tab-middle-chats, .tab-middle-chats2 {
      flex: 1;
      background-color: #f6f5f4;
      overflow: hidden;
    }
    
    #tab-footer {
      height: 24px;
      background-color: #e2e1e0;
      display: flex;
      align-items: center;
      padding: 0 15px;
      font-size: 12px;
      color: #3d3846;
      border-top: 1px solid #d1cfcc;
    }
    
    .resp-iframe, .resp2-iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    
    /* File browser items */
    .file-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    
    .file-item:hover {
      background-color: rgba(120, 174, 237, 0.2);
    }
    
    .file-item img {
      width: 48px;
      height: 48px;
      margin-bottom: 5px;
    }
    
    .file-item .file-name {
      font-size: 12px;
      color: #3d3846;
      text-align: center;
      word-break: break-word;
    }
    
    /* Firefox Browser Styles */
    #tab-firefox {
      background-color: #2d2d2d;
      width: 900px;
      height: 600px;
    }
    
    #tab-firefox .tab-header {
      background-color: #1e1e1e;
      color: #f0f0f0;
    }
    
    #firefox-url {
      width: 100%;
      background: #3d3d3d;
      border: 1px solid #4d4d4d;
      color: #f0f0f0;
      padding: 3px 8px;
      border-radius: 3px;
      margin: 0 15px;
    }
    
    #tab-firefox #tab-footer {
      background-color: #1e1e1e;
      color: #a0a0a0;
      font-size: 12px;
      padding: 3px 10px;
    }
    
    /* App Menu */
    #appMenu {
  position: fixed;
  bottom: 50px;          /* Position above the panel */
  left: 10px;            /* Align with the panel */
  width: 250px;
  background-color: rgba(40, 40, 40, 0.95);  /* Dark semi-transparent background */
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5); /* Stronger shadow for depth */
  display: none;         /* Hidden by default */
  z-index: 1001;         /* Ensure it appears above other elements */
  backdrop-filter: blur(10px); /* Blur effect for modern browsers */
  border: 1px solid rgba(255, 255, 255, 0.1); /* Subtle border */
  padding: 8px 0;        /* Spacing inside menu */
  color: #ffffff;        /* White text for better contrast */
}
    
    .app-menu-item {
      padding: 10px 15px;
      cursor: pointer;
      display: flex;
      align-items: center;
    }
    
    .app-menu-item i {
      margin-right: 10px;
      width: 20px;
      text-align: center;
    }
    
    .app-menu-item:hover {
      background-color: #78aeed;
      color: white;
    }
    
/* Right Click Menu */
#body-rmenu {
  position: absolute;
  width: 220px;
  background: rgba(45, 45, 50, 0.98);
  border-radius: 8px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3),
              0 0 0 1px rgba(255, 255, 255, 0.05);
  display: none;
  z-index: 1001;
  backdrop-filter: blur(10px);
  padding: 6px 0;
  color: #f0f0f0;
  font-size: 14px;
  border: 1px solid rgba(255, 255, 255, 0.08);
}

#body-rmenu ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

#body-rmenu li {
  padding: 8px 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  transition: all 0.2s;
  position: relative;
}

#body-rmenu li:hover {
  background: rgba(120, 174, 237, 0.25);
  color: white;
}

#body-rmenu li i {
  margin-right: 12px;
  width: 18px;
  text-align: center;
  color: #78aeed;
  font-size: 13px;
}

#sub-menu {
  display: none;
  position: absolute;
  left: calc(100% - 10px);
  top: -6px;
  width: 200px;
  background: rgba(45, 45, 50, 0.98);
  border-radius: 8px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
  z-index: 1002;
  backdrop-filter: blur(10px);
  padding: 6px 0;
  border: 1px solid rgba(255, 255, 255, 0.08);
}

#change-bg:hover #sub-menu {
  display: block;
  animation: fadeIn 0.15s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateX(10px); }
  to { opacity: 1; transform: translateX(0); }
}
    
    /* Selected Item */
    .selected {
      background-color: rgba(120, 174, 237, 0.3) !important;
    }

    /* Terminal Styles */
#terminal {
  padding: 1em;
  height: 100%;
  overflow-y: auto;
  background-color: black;
  color: lime;
  font-family: monospace;
}
.terminal-line {
  display: flex;
  flex-wrap: wrap;
}
.prompt {
  margin-right: 0.5em;
  color: lime;
}
#input-line {
  outline: none;
  border: none;
  background: transparent;
  color: lime;
  flex-grow: 1;
  font-family: monospace;
  font-size: 1em;
}

/* Settings Window Specific Styles */
.settings-category {
  padding: 12px 20px;
  cursor: pointer;
  transition: all 0.3s;
  font-weight: 500;
  color: #3d3846;
  border-left: 4px solid transparent;
}

.settings-category:hover {
  background: rgba(120, 174, 237, 0.1);
  color: #241f31;
}

.settings-category.active {
  background: rgba(120, 174, 237, 0.15);
  border-left: 4px solid #78aeed;
  color: #241f31;
}

.settings-card {
  background: white;
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.slider-container {
  margin: 15px 0;
}

.slider {
  width: 100%;
  height: 6px;
  border-radius: 3px;
  background: #e2e1e0;
  outline: none;
  -webkit-appearance: none;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #78aeed;
  cursor: pointer;
}

/* Wallpaper Settings Styles */
.wallpaper-thumb {
  height: 120px;
  background-size: cover;
  background-position: center;
  border-radius: 6px;
  cursor: pointer;
  position: relative;
  transition: all 0.2s ease;
  overflow: hidden;
  border: 2px solid transparent;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.wallpaper-thumb:hover {
  transform: scale(1.02);
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  border-color: #78aeed;
}

.wallpaper-thumb span {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(61, 56, 70, 0.85);
  color: white;
  padding: 6px;
  font-size: 12px;
  text-align: center;
}

/* Make select elements match the theme */
select {
  background: white;
  border: 1px solid #d1cfcc;
  color: #3d3846;
  font-family: 'Ubuntu', sans-serif;
  transition: border-color 0.2s;
}

select:focus {
  outline: none;
  border-color: #78aeed;
  box-shadow: 0 0 0 2px rgba(120, 174, 237, 0.2);
}

/* Apply button styling */
button {
  transition: all 0.2s;
}

button:hover {
  background: #6a9ed6 !important;
  transform: translateY(-1px);
}

button:active {
  transform: translateY(0);
}

  </style>
</head>

<body class="disable-select">

<!-- Starting Screen -->
<div id="starting-win">
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Tux.svg/1200px-Tux.svg.png" alt="Linux" style="width: 80px;"/>
  <div class="ring">
    <div class="indicator-1 indeterminate-ring"></div>
    <div class="indicator-2 indeterminate-ring"></div>
    <div class="indicator-3 indeterminate-ring"></div>
    <div class="indicator-4 indeterminate-ring"></div>
    <div class="indicator-5 indeterminate-ring"></div>
  </div>
</div>

<!-- Loader -->
<div id="loader">
  <i class="fas fa-cog fa-spin fa-3x" style="color: rgba(120, 174, 237, 0.5)"></i>
  <span class="sr-only">Loading...</span>
</div>

<!-- Desktop Area -->
<div id="main">

  <!-- File Manager -->
  <div class="desktop-item" title="Files" ondblclick="$('#tab').show(); clearSelection(this);" onclick="selectedItem(this)">
    <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" alt="Files" />
    <p class="icon-name">Files</p>
  </div>

  <!-- Terminal -->
  <div class="desktop-item" title="Terminal" ondblclick="$('#tab-calc').show(); clearSelection(this);" onclick="selectedItem(this)">
    <img src="https://raw.githubusercontent.com/PapirusDevelopmentTeam/papirus-icon-theme/master/Papirus/64x64/apps/utilities-terminal.svg" 
         class="linux-icon" alt="Terminal" style="width:48px;height:48px;" />
    <p class="icon-name">Terminal</p>
  </div>

  <!-- Firefox Browser -->
<div class="desktop-item" title="Firefox" ondblclick="$('#tab-firefox').show(); clearSelection(this);" onclick="selectedItem(this)">
  <img src="https://raw.githubusercontent.com/PapirusDevelopmentTeam/papirus-icon-theme/master/Papirus/64x64/apps/firefox.svg" 
       class="linux-icon firefox-icon" alt="Firefox" style="width:48px;height:48px;" />
  <p class="icon-name">Firefox</p>
</div>

  <!-- Settings -->
  <div class="desktop-item" title="Settings" ondblclick="$('#tab-settings').show(); clearSelection(this);" onclick="selectedItem(this)">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" style="width:48px;height:48px">
      <!-- Outer glow circle -->
      <circle cx="24" cy="24" r="22" fill="none" stroke="url(#neon-glow)" stroke-width="2" stroke-dasharray="3,3" opacity="0.8"/>
      
      <!-- Inner control panel -->
      <circle cx="24" cy="24" r="16" fill="#3d3846" stroke="#78aeed" stroke-width="1.5"/>
      
      <!-- Toggle switches -->
      <path fill="#78aeed" d="M24 12a2 2 0 0 1 2 2v3a2 2 0 0 1-4 0v-3a2 2 0 0 1 2-2zM12 24a2 2 0 0 1 2-2h3a2 2 0 0 1 0 4h-3a2 2 0 0 1-2-2zM24 36a2 2 0 0 1-2-2v-3a2 2 0 0 1 4 0v3a2 2 0 0 1-2 2zM36 24a2 2 0 0 1-2 2h-3a2 2 0 0 1 0-4h3a2 2 0 0 1 2 2z"/>
      
      <!-- Center gear -->
      <circle cx="24" cy="24" r="5" fill="#78aeed"/>
      <circle cx="24" cy="24" r="3" fill="#3d3846"/>
      
      <defs>
        <linearGradient id="neon-glow" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="#78aeed"/>
          <stop offset="100%" stop-color="#a3c7f7"/>
        </linearGradient>
        <filter id="glow" x="-30%" y="-30%" width="160%" height="160%">
          <feGaussianBlur stdDeviation="2" result="blur"/>
          <feComposite in="SourceGraphic" in2="blur" operator="over"/>
        </filter>
      </defs>
    </svg>
    <p class="icon-name">Settings</p>
  </div>

<!-- Panel (Linux-style taskbar) -->
<div id="panel">
  <!-- Inside the #panel section -->
<div class="panel-icon" onclick="$('#appMenu').fadeToggle(200);">
  <i class="fas fa-bars"></i> <!-- Menu icon -->
    <span>Applications</span>
  </div>
  
  <div class="panel-icon" title="Show Desktop" onclick="minimizeAllWindows()">
    <i class="fas fa-desktop"></i>
  </div>
  
  <div id="system-tray">
    <div class="panel-icon" title="Network">
      <i class="fas fa-wifi"></i>
    </div>
    <div class="panel-icon" title="Sound">
      <i class="fas fa-volume-up"></i>
    </div>
    <div class="panel-icon" title="Battery">
      <i class="fas fa-battery-three-quarters"></i>
    </div>
    <div id="clock" title="Current date and time"></div>
  </div>
</div>

<!-- App Menu -->
<div id="appMenu">
  <div class="app-menu-item" onclick="$('#tab').show(); $('#appMenu').hide();">
    <i class="fas fa-folder"></i>
    <span>Files</span>
  </div>
  <div class="app-menu-item" onclick="$('#tab-calc').show(); $('#appMenu').hide();">
    <i class="fas fa-terminal"></i>
    <span>Terminal</span>
  </div>
  <div class="app-menu-item" onclick="$('#tab-firefox').show(); $('#appMenu').hide();">
    <i class="fas fa-globe"></i>
    <span>Firefox Browser</span>
  </div>
  <div class="app-menu-item" onclick="alert('Settings app would open here'); $('#appMenu').hide();">
    <i class="fas fa-cog"></i>
    <span>Settings</span>
  </div>
  <div class="app-menu-item" style="border-top: 1px solid #d1cfcc; margin-top: 5px;" onclick="logout()">
    <i class="fas fa-power-off"></i>
    <span>Power Off</span>
  </div>
</div>

<!-- Windows (Tabs) -->

<!-- Files Window -->
<div id="tab" class="window" style="left: 100px; top: 50px;">
  <div class="tab-header">
    <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" style="width:20px;height:20px;margin-right:8px;filter: hue-rotate(190deg) saturate(1.5);" alt="Files" />
    Files <i class="fas fa-times" onclick="$('#tab').hide()"></i>
  </div>
  <div class="tab-middle">
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" style="filter: hue-rotate(190deg) saturate(1.5);" alt="Documents">
      <span class="file-name">Documents</span>
    </div>
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" style="filter: hue-rotate(190deg) saturate(1.5);" alt="Downloads">
      <span class="file-name">Downloads</span>
    </div>
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" style="filter: hue-rotate(190deg) saturate(1.5);" alt="Music">
      <span class="file-name">Music</span>
    </div>
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" style="filter: hue-rotate(190deg) saturate(1.5);" alt="Pictures">
      <span class="file-name">Pictures</span>
    </div>
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" style="filter: hue-rotate(190deg) saturate(1.5);" alt="Videos">
      <span class="file-name">Videos</span>
    </div>
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/2965/2965300.png" alt="File">
      <span class="file-name">notes.txt</span>
    </div>
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/2965/2965300.png" alt="File">
      <span class="file-name">report.pdf</span>
    </div>
    <div class="file-item">
      <img src="https://cdn-icons-png.flaticon.com/512/2965/2965300.png" alt="File">
      <span class="file-name">presentation.pptx</span>
    </div>
  </div>
  <div id="tab-footer">
    <i class="fas fa-info-circle" style="margin-right: 5px;"></i> 8 items, Free space: 120 GB
  </div>
</div>


<!-- Terminal Window -->
<div id="tab-calc" class="window" style="left: 150px; top: 100px;">
  <div class="tab-header">
    <img src="https://raw.githubusercontent.com/PapirusDevelopmentTeam/papirus-icon-theme/master/Papirus/64x64/apps/utilities-terminal.svg" style="width:20px;height:20px;margin-right:8px;" alt="Terminal" />
    Terminal <i class="fas fa-times" onclick="$('#tab-calc').hide();"></i>
  </div>
  <div class="tab-middle-chats2" style="padding:0;background-color:black;">
    <div id="terminal-container" style="height:100%;overflow:hidden;">
      <div id="terminal">
        <div class="line">
          <span class="prompt" id="prompt">user@linux:~$</span>
          <input id="input-line" autofocus />
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Firefox Browser Window -->
<div id="tab-firefox" class="window" style="left: 200px; top: 150px; width: 900px; height: 600px;">
  <div class="tab-header" style="background-color: #1e1e1e; color: #f0f0f0;">
    <img src="https://raw.githubusercontent.com/PapirusDevelopmentTeam/papirus-icon-theme/master/Papirus/16x16/apps/firefox.svg" 
         class="linux-icon" style="width:16px;height:16px;margin-right:8px;" alt="Firefox" />
    Firefox Browser
    <div style="flex-grow:1;margin:0 15px;display:flex;align-items:center;">
      <div style="display:flex;width:100%;">
        <button id="back-button" style="background:#3d3d3d;border:1px solid #4d4d4d;color:#f0f0f0;padding:3px 8px;border-radius:3px 0 0 3px;border-right:none;cursor:pointer;">
          <i class="fas fa-arrow-left"></i>
        </button>
        <button id="forward-button" style="background:#3d3d3d;border:1px solid #4d4d4d;color:#f0f0f0;padding:3px 8px;border-right:none;cursor:pointer;">
          <i class="fas fa-arrow-right"></i>
        </button>
        <button id="refresh-button" style="background:#3d3d3d;border:1px solid #4d4d4d;color:#f0f0f0;padding:3px 8px;border-right:none;cursor:pointer;">
          <i class="fas fa-sync-alt"></i>
        </button>
        <input type="text" id="firefox-url" value="https://www.google.com" 
               style="flex-grow:1;background:#3d3d3d;border:1px solid #4d4d4d;color:#f0f0f0;padding:3px 8px;border-radius:0 3px 3px 0;">
      </div>
    </div>
    <i class="fas fa-times" onclick="$('#tab-firefox').hide();"></i>
  </div>
  <div class="tab-middle-chats" style="height:calc(100% - 64px);">
    <div id="google-container" style="width:100%;height:100%;background:white;display:flex;flex-direction:column;">
      <!-- Google Search Box -->
      <div style="margin:auto;text-align:center;padding:20px;width:100%;max-width:600px;">
        <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" 
             style="width:200px;margin-bottom:20px;">
        <form id="google-search-form" style="width:100%;">
          <div style="position:relative;width:100%;">
            <input type="text" id="google-search-input" 
                   style="width:100%;padding:10px 15px;border-radius:24px;border:1px solid #dfe1e5;font-size:16px;"
                   autocomplete="off">
            <div style="position:absolute;right:10px;top:50%;transform:translateY(-50%);display:flex;gap:10px;">
              <i class="fas fa-search" style="color:#9aa0a6;"></i>
              <i class="fas fa-microphone" style="color:#4285f4;"></i>
            </div>
          </div>
          <div style="margin-top:20px;">
            <button type="submit" style="background:#f8f9fa;border:1px solid #f8f9fa;border-radius:4px;color:#3c4043;
                    padding:8px 16px;margin:0 4px;cursor:pointer;">Google Search</button>
            <button type="button" onclick="imFeelingLucky()" style="background:#f8f9fa;border:1px solid #f8f9fa;border-radius:4px;
                    color:#3c4043;padding:8px 16px;margin:0 4px;cursor:pointer;">I'm Feeling Lucky</button>
          </div>
        </form>
      </div>
      
      <!-- Search Results Container -->
      <div id="search-results" style="flex:1;overflow-y:auto;padding:20px;display:none;"></div>
    </div>
  </div>
  <div id="tab-footer" style="background-color:#1e1e1e;color:#a0a0a0;font-size:12px;padding:3px 10px;height:24px;display:flex;align-items:center;">
    <i class="fas fa-lock" style="margin-right:5px;"></i> Secure connection - google.com
  </div>
</div>


<!-- Settings Window -->
<div id="tab-settings" class="window" style="left: 150px; top: 100px; width: 700px; height: 500px;">
  <div class="tab-header" style="background: linear-gradient(90deg, #3d3846 0%, #4a4454 100%);">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" style="margin-right:8px">
      <path fill="#78aeed" d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5zm7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-.97l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65A.488.488 0 0 0 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.31-.07.64-.07.97 0 .33.03.66.07.97l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65z"/>
    </svg>
    System Settings <i class="fas fa-times" onclick="$('#tab-settings').hide()"></i>
  </div>
  <div class="tab-middle" style="display:flex;padding:0;background:#f6f5f4;">
    <div style="width:200px;background:#e2e1e0;padding:15px 0;height:100%;border-right:1px solid #d1cfcc;">
      <div class="settings-category active" onclick="changeSettingsTab('system')">
        <i class="fas fa-sliders-h" style="margin-right:8px;color:#78aeed;"></i> System
      </div>
      <div class="settings-category" onclick="changeSettingsTab('devices')">
        <i class="fas fa-keyboard" style="margin-right:8px;color:#666;"></i> Devices
      </div>
      <div class="settings-category" onclick="changeSettingsTab('network')">
        <i class="fas fa-wifi" style="margin-right:8px;color:#666;"></i> Network
      </div>
      <div class="settings-category" onclick="changeSettingsTab('appearance')">
        <i class="fas fa-palette" style="margin-right:8px;color:#666;"></i> Appearance
      </div>
    </div>
    <div id="settings-content" style="flex:1;padding:20px;overflow-y:auto;">
      <!-- Dynamic content loads here -->
      <div id="system-settings" class="settings-tab-content">
        <h2 style="color:#3d3846;margin-top:0;">System Preferences</h2>
        <div class="settings-card">
          <h3><i class="fas fa-sun" style="color:#78aeed;"></i> Display</h3>
          <div class="slider-container">
            <label>Brightness</label>
            <input type="range" class="slider" min="0" max="100" value="70">
          </div>
        </div>
        <div class="settings-card">
          <h3><i class="fas fa-volume-up" style="color:#78aeed;"></i> Sound</h3>
          <div class="slider-container">
            <label>Volume</label>
            <input type="range" class="slider" min="0" max="100" value="50">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Right Click Menu -->
<div id="body-rmenu">
  <ul>
    <li onclick="location.reload()">
      <i class="fas fa-sync-alt"></i>
      <span>Refresh</span>
    </li>
    <li id="change-bg">
      <i class="fas fa-image"></i>
      <span>Change Wallpaper</span>
      <span style="float: right;"><i class="fas fa-chevron-right"></i></span>
      <ul id="sub-menu">
        <li onclick="changeWallpaper('mountains')"><i class="fas fa-mountain"></i> Mountains</li>
        <li onclick="changeWallpaper('forest')"><i class="fas fa-tree"></i> Forest</li>
        <li onclick="changeWallpaper('ocean')"><i class="fas fa-water"></i> Ocean</li>
        <li onclick="changeWallpaper('space')"><i class="fas fa-moon"></i> Space</li>
        <li onclick="changeWallpaper('city')"><i class="fas fa-city"></i> City</li>
        <li onclick="changeWallpaper('custom')"><i class="fas fa-upload"></i> Custom...</li>
      </ul>
    </li>
    <li onclick="openWallpaperSettings()">
      <i class="fas fa-sliders-h"></i>
      <span>Wallpaper Settings</span>
    </li>
  </ul>
</div>

<!-- Wallpaper Settings Window -->
<div id="tab-wallpaper" class="window" style="left: 200px; top: 100px; width: 700px; height: 500px;">
  <div class="tab-header" style="background: linear-gradient(90deg, #3d3846 0%, #4a4454 100%); color: white;">
    <i class="fas fa-image" style="margin-right:8px; color:#78aeed;"></i>
    Wallpaper Settings <i class="fas fa-times" onclick="$('#tab-wallpaper').hide()" style="color:white;"></i>
  </div>
  <div class="tab-middle" style="padding:20px;overflow-y:auto;background:#f6f5f4;color:#3d3846;">
    <h3 style="margin-top:0;color:#3d3846;">Current Wallpaper</h3>
    <div id="current-wallpaper-preview" style="height:150px;background-size:cover;background-position:center;margin-bottom:20px;border-radius:8px;border:2px solid #78aeed;box-shadow: 0 2px 4px rgba(0,0,0,0.1);"></div>
    
    <h3 style="color:#3d3846;">Wallpaper Collection</h3>
    <div style="display:grid;grid-template-columns:repeat(3, 1fr);gap:15px;margin-bottom:20px;">
      <div class="wallpaper-thumb" onclick="previewWallpaper('mountains')" style="background-image:url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
        <span>Mountains</span>
      </div>
      <div class="wallpaper-thumb" onclick="previewWallpaper('forest')" style="background-image:url('https://images.unsplash.com/photo-1448375240586-882707db888b?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
        <span>Forest</span>
      </div>
      <div class="wallpaper-thumb" onclick="previewWallpaper('ocean')" style="background-image:url('https://images.unsplash.com/photo-1505118380757-91f5f5632de0?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
        <span>Ocean</span>
      </div>
      <div class="wallpaper-thumb" onclick="previewWallpaper('space')" style="background-image:url('https://images.unsplash.com/photo-1462331940025-496dfbfc7564?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
        <span>Space</span>
      </div>
      <div class="wallpaper-thumb" onclick="previewWallpaper('city')" style="background-image:url('https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
        <span>City</span>
      </div>
      <div class="wallpaper-thumb" onclick="openCustomWallpaper()" style="background-color:#e2e1e0;display:flex;flex-direction:column;align-items:center;justify-content:center;">
        <i class="fas fa-plus" style="font-size:24px;color:#3d3846;"></i>
        <span style="color:#3d3846;">Custom</span>
      </div>
    </div>
    
    <h3 style="color:#3d3846;">Display Options</h3>
    <div style="margin-bottom:15px;">
      <label style="display:block;margin-bottom:8px;color:#3d3846;">Scaling Mode:</label>
      <select id="wallpaper-scale" style="padding:8px;border-radius:4px;border:1px solid #d1cfcc;width:100%;background:white;color:#3d3846;">
        <option value="cover">Zoom to Fill</option>
        <option value="contain">Fit to Screen</option>
        <option value="stretch">Stretch</option>
        <option value="repeat">Tile</option>
      </select>
    </div>
    
    <div>
      <button onclick="applyWallpaper()" style="background:#78aeed;color:white;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:500;width:100%;">
        <i class="fas fa-check" style="margin-right:8px;"></i> Apply Wallpaper
      </button>
    </div>
  </div>
</div>

<!-- Hidden file input for custom wallpapers -->
<input type="file" id="custom-wallpaper-input" accept="image/*" style="display:none;">

<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
// Simulate loading
setTimeout(function() {
  $('#starting-win').fadeOut(1000);
}, 3000);

// Prevent Right-Click Menu Globally
document.addEventListener('contextmenu', function(e) {
  e.preventDefault();
  const x = e.clientX;
  const y = e.clientY;
  $('#body-rmenu').css({
    'display': 'block',
    'left': x + 'px',
    'top': y + 'px'
  });
});

// Close right-click menu when clicking elsewhere
document.addEventListener('click', function() {
  $('#body-rmenu').hide();
  $('#appMenu').hide();
});

// Fullscreen Toggle
function toggleFullScreen() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    if (document.exitFullscreen) {
      document.exitFullscreen();
    }
  }
}

// Live Clock Update
function updateClock() {
  const now = new Date();
  const timeString = now.toLocaleTimeString();
  document.getElementById('clock').textContent = timeString;
}
setInterval(updateClock, 1000);
updateClock();

// Selected Item
function selectedItem(item) {
  $('.desktop-item').removeClass('selected');
  $(item).addClass('selected');
}

// Clear item background when opening window
function clearSelection(item) {
  $('.desktop-item').removeClass('selected');
}

// Change Background
function changeBg(num) {
  const backgrounds = [
    'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b',
    'https://images.unsplash.com/photo-1448375240586-882707db888b',
    'https://images.unsplash.com/photo-1505118380757-91f5f5632de0',
    'https://images.unsplash.com/photo-1462331940025-496dfbfc7564',
    'https://images.unsplash.com/photo-1477959858617-67f85cf4f1df'
  ];
  if (num >= 1 && num <= backgrounds.length) {
    $('body').css('background-image', 'url(' + backgrounds[num-1] + ')');
  }
  $('#body-rmenu').hide();
}

// Logout Function
function logout() {
  localStorage.clear();
  alert('Logging out...');
  window.location.reload();
}

// Minimize all windows
function minimizeAllWindows() {
  $('.window').hide();
}

// Make windows draggable
$(function() {
  $(".window").draggable({
    handle: ".tab-header",
    containment: "document"
  });
});

// Firefox browser functionality
$(document).ready(function() {
  // Handle URL navigation
  $('#firefox-url').on('keypress', function(e) {
    if(e.which === 13) { // Enter key
      let url = $(this).val();
      if(!url.startsWith('http://') && !url.startsWith('https://')) {
        url = 'https://' + url;
        $(this).val(url);
      }
      $('#firefox-frame').attr('src', url);
      
      // Update status (simplified)
      $('#tab-footer').html('<i class="fas fa-sync-alt fa-spin" style="margin-right:5px;"></i> Loading...');
      setTimeout(function() {
        $('#tab-footer').html('<i class="fas fa-lock" style="margin-right:5px;"></i> Secure connection - ' + 
                             (new URL(url)).hostname);
      }, 1500);
    }
  });
  
  // Simulate browser controls
  $(document).on('dblclick', '[alt="Firefox"]', function() {
    $('#firefox-frame').attr('src', 'https://www.mozilla.org');
    $('#firefox-url').val('https://www.mozilla.org');
  });
});

// Terminal functionality
const terminal = document.getElementById('terminal');
let inputLine = document.getElementById('input-line');
let promptSpan = document.getElementById('prompt');

let currentPath = '/home/user';
let isRoot = false;
let fakeFileSystem = ['file1.txt', 'file2.txt', 'project'];

inputLine.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    const command = inputLine.value.trim();
    const newLine = document.createElement('div');
    newLine.classList.add('terminal-line');
    newLine.innerHTML = `<span class="prompt">${promptSpan.textContent}</span><span>${command}</span>`;
    terminal.insertBefore(newLine, inputLine.parentNode);

    const outputLine = document.createElement('div');
    outputLine.textContent = simulateTerminalCommand(command);
    terminal.insertBefore(outputLine, inputLine.parentNode);

    inputLine.value = '';
    terminal.scrollTop = terminal.scrollHeight;
  }
});

function simulateTerminalCommand(cmd) {
  if (cmd === '') return '';

  if (cmd === 'help') {
    return 'Available commands: help, clear, echo, date, whoami, pwd, ls, mkdir, sudo su, exit';
  }

  if (cmd === 'clear') {
    terminal.innerHTML = '';
    const newInput = document.createElement('div');
    newInput.classList.add('terminal-line');
    newInput.innerHTML = `<span class="prompt" id="prompt">${isRoot ? 'root@linux:~#' : 'user@linux:~$'}</span><input id="input-line" autofocus />`;
    terminal.appendChild(newInput);
    inputLine = document.getElementById('input-line');
    promptSpan = document.getElementById('prompt');
    inputLine.addEventListener('keydown', arguments.callee);
    return '';
  }

  if (cmd === 'date') {
    return new Date().toString();
  }

  if (cmd === 'whoami') {
    return isRoot ? 'root' : 'user';
  }

  if (cmd === 'pwd') {
    return currentPath;
  }

  if (cmd === 'ls') {
    return fakeFileSystem.join('\n');
  }

  if (cmd.startsWith('mkdir ')) {
    const folderName = cmd.split(' ')[1];
    if (folderName) {
      fakeFileSystem.push(folderName);
      return '';
    } else {
      return 'mkdir: missing operand';
    }
  }

  if (cmd === 'sudo su') {
    isRoot = true;
    promptSpan.textContent = 'root@linux:~#';
    return '';
  }

  if (cmd === 'exit') {
    isRoot = false;
    promptSpan.textContent = 'user@linux:~$';
    return '';
  }

  if (cmd.startsWith('echo ')) {
    return cmd.slice(5);
  }

  return `Command not found: ${cmd}`;
}

// Focus the terminal input when the window is shown
$(document).on('click', '[alt="Terminal"], #tab-calc .tab-header', function() {
  if ($('#tab-calc').is(':visible')) {
    $('#input-line').focus();
  }
});


// Firefox browser functionality
$(document).ready(function() {
  // Handle URL navigation
  $('#firefox-url').on('keypress', function(e) {
    if(e.which === 13) { // Enter key
      let url = $(this).val();
      
      // If it's not a URL (no dots and no protocol), treat as search query
      if(!url.includes('.') && !url.startsWith('http://') && !url.startsWith('https://')) {
        const searchEngine = $('#search-engine').val();
        url = searchEngine + encodeURIComponent(url);
        $(this).val(url);
      } else if(!url.startsWith('http://') && !url.startsWith('https://')) {
        url = 'https://' + url;
        $(this).val(url);
      }
      
      $('#firefox-frame').attr('src', url);
      
      // Update status (simplified)
      $('#tab-footer').html('<i class="fas fa-sync-alt fa-spin" style="margin-right:5px;"></i> Loading...');
      setTimeout(function() {
        const domain = new URL(url).hostname.replace('www.', '');
        $('#tab-footer').html('<i class="fas fa-lock" style="margin-right:5px;"></i> Secure connection - ' + domain);
      }, 1500);
    }
  });
  
  // Simulate browser controls
  $(document).on('dblclick', '[alt="Firefox"]', function() {
    $('#firefox-frame').attr('src', 'https://www.mozilla.org');
    $('#firefox-url').val('https://www.mozilla.org');
    $('#search-engine').val('https://www.google.com/search?q=');
  });
});


// Firefox browser functionality with Google search
$(document).ready(function() {
  // Handle Google search form submission
  $('#google-search-form').on('submit', function(e) {
    e.preventDefault();
    const query = $('#google-search-input').val().trim();
    if(query) {
      performGoogleSearch(query);
    }
  });
  
  // Handle URL navigation
  $('#firefox-url').on('keypress', function(e) {
    if(e.which === 13) { // Enter key
      let url = $(this).val();
      
      // Add https:// if not present
      if(!url.startsWith('http://') && !url.startsWith('https://')) {
        url = 'https://' + url;
        $(this).val(url);
      }
      
      // If it's a search term (no dots), perform Google search
      if(!url.includes('.') && !url.includes('/')) {
        performGoogleSearch(url);
        return;
      }
      
      // Try to load external URL (note: many sites block iframes)
      try {
        $('#google-container').html(`
          <div style="width:100%;height:100%;display:flex;justify-content:center;align-items:center;">
            <div style="text-align:center;">
              <i class="fas fa-exclamation-triangle" style="font-size:48px;color:#fbbc05;margin-bottom:20px;"></i>
              <p>This website cannot be displayed in the preview</p>
              <p>Would you like to open it in a new tab?</p>
              <button onclick="window.open('${url}', '_blank')" 
                      style="background:#4285f4;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;">
                Open in New Tab
              </button>
            </div>
          </div>
        `);
      } catch(e) {
        console.error("Error loading URL:", e);
      }
    }
  });
  
  // Navigation buttons (simulated)
  $('#back-button').click(function() {
    // In a real implementation, this would track navigation history
    showGoogleHome();
  });
  
  $('#forward-button').click(function() {
    // In a real implementation, this would track navigation history
    alert("Forward navigation not implemented in this demo");
  });
  
  $('#refresh-button').click(function() {
    showGoogleHome();
  });
  
  // Simulate browser controls
  $(document).on('dblclick', '[alt="Firefox"]', function() {
    showGoogleHome();
  });
});

function showGoogleHome() {
  $('#google-container').html(`
    <div style="margin:auto;text-align:center;padding:20px;width:100%;max-width:600px;">
      <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" 
           style="width:200px;margin-bottom:20px;">
      <form id="google-search-form" style="width:100%;">
        <div style="position:relative;width:100%;">
          <input type="text" id="google-search-input" 
                 style="width:100%;padding:10px 15px;border-radius:24px;border:1px solid #dfe1e5;font-size:16px;"
                 autocomplete="off">
          <div style="position:absolute;right:10px;top:50%;transform:translateY(-50%);display:flex;gap:10px;">
            <i class="fas fa-search" style="color:#9aa0a6;"></i>
            <i class="fas fa-microphone" style="color:#4285f4;"></i>
          </div>
        </div>
        <div style="margin-top:20px;">
          <button type="submit" style="background:#f8f9fa;border:1px solid #f8f9fa;border-radius:4px;color:#3c4043;
                  padding:8px 16px;margin:0 4px;cursor:pointer;">Google Search</button>
          <button type="button" onclick="imFeelingLucky()" style="background:#f8f9fa;border:1px solid #f8f9fa;border-radius:4px;
                  color:#3c4043;padding:8px 16px;margin:0 4px;cursor:pointer;">I'm Feeling Lucky</button>
        </div>
      </form>
    </div>
    <div id="search-results" style="flex:1;overflow-y:auto;padding:20px;display:none;"></div>
  `);
  
  // Re-attach event listeners
  $('#google-search-form').on('submit', function(e) {
    e.preventDefault();
    const query = $('#google-search-input').val().trim();
    if(query) {
      performGoogleSearch(query);
    }
  });
  
  $('#firefox-url').val('https://www.google.com');
}

function performGoogleSearch(query) {
  // Show loading state
  $('#google-container').html(`
    <div style="width:100%;height:100%;display:flex;justify-content:center;align-items:center;">
      <i class="fas fa-spinner fa-spin" style="font-size:48px;color:#4285f4;"></i>
    </div>
  `);
  
  // Simulate search results after a delay
  setTimeout(() => {
    $('#google-container').html(`
      <div style="width:100%;height:100%;display:flex;flex-direction:column;">
        <div style="padding:20px;border-bottom:1px solid #ebebeb;display:flex;align-items:center;">
          <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_92x30dp.png" 
               style="height:30px;margin-right:20px;">
          <div style="position:relative;flex-grow:1;max-width:600px;">
            <input type="text" value="${query}" 
                   style="width:100%;padding:8px 15px;border-radius:24px;border:1px solid #dfe1e5;font-size:16px;">
          </div>
        </div>
        <div style="flex:1;overflow-y:auto;padding:20px;">
          <div style="max-width:600px;margin:0 auto;">
            <p style="color:#70757a;font-size:14px;">About 1,000,000 results (0.39 seconds)</p>
            
            <!-- Sample search results -->
            ${generateSampleResults(query)}
            
            <div style="margin-top:30px;text-align:center;">
              <div style="display:inline-block;">
                <span style="display:inline-block;padding:8px 16px;background:#4285f4;color:white;border-radius:4px;cursor:pointer;">
                  Next
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    `);
    
    $('#firefox-url').val(`https://www.google.com/search?q=${encodeURIComponent(query)}`);
  }, 1000);
}

function generateSampleResults(query) {
  const results = [];
  const domains = [
    'wikipedia.org',
    'youtube.com',
    'github.com',
    'stackoverflow.com',
    'medium.com',
    'reddit.com'
  ];
  
  for(let i = 0; i < 5; i++) {
    const domain = domains[i % domains.length];
    results.push(`
      <div style="margin-bottom:30px;">
        <p style="color:#202124;font-size:20px;margin:0 0 5px 0;cursor:pointer;">
          ${query} - ${domain.split('.')[0].charAt(0).toUpperCase() + domain.split('.')[0].slice(1)}
        </p>
        <p style="color:#006621;font-size:14px;margin:0 0 5px 0;">
          https://www.${domain}/search?q=${encodeURIComponent(query)}
        </p>
        <p style="color:#4d5156;font-size:14px;margin:0;">
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. ${query} is a popular search term. 
          Nulla facilisi. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
        </p>
      </div>
    `);
  }
  
  return results.join('');
}

function imFeelingLucky() {
  const query = $('#google-search-input').val().trim();
  if(query) {
    alert(`I'm Feeling Lucky would normally take you directly to the first result for "${query}"`);
  }
}

// Make sliders interactive
$(document).on('input', '.slider', function() {
  const value = $(this).val();
  $(this).css('background', `linear-gradient(90deg, #78aeed 0%, #78aeed ${value}%, #e2e1e0 ${value}%, #e2e1e0 100%)`);
});

// Initialize sliders on window open
$(document).on('click', '[title="Settings"]', function() {
  $('.slider').trigger('input');
});

// Wallpaper functionality
let currentWallpaper = 'mountains';
let pendingWallpaper = null;
let customWallpaperUrl = null;

const wallpapers = {
  'mountains': 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b',
  'forest': 'https://images.unsplash.com/photo-1448375240586-882707db888b',
  'ocean': 'https://images.unsplash.com/photo-1505118380757-91f5f5632de0',
  'space': 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564',
  'city': 'https://images.unsplash.com/photo-1477959858617-67f85cf4f1df'
};

// Initialize wallpaper
function initWallpaper() {
  const savedWallpaper = localStorage.getItem('linuxWallpaper');
  const savedScale = localStorage.getItem('wallpaperScale') || 'cover';
  
  if (savedWallpaper) {
    if (savedWallpaper.startsWith('custom:')) {
      customWallpaperUrl = savedWallpaper.replace('custom:', '');
      document.body.style.backgroundImage = `url(${customWallpaperUrl})`;
    } else {
      document.body.style.backgroundImage = `url(${wallpapers[savedWallpaper]}?ixlib=rb-1.2.1&auto=format&fit=crop&w=${window.screen.width}&h=${window.screen.height}&q=80)`;
    }
    currentWallpaper = savedWallpaper;
  }
  
  document.body.style.backgroundSize = savedScale;
  document.getElementById('wallpaper-scale').value = savedScale;
  updateWallpaperPreview();
}

// Change wallpaper from right-click menu
function changeWallpaper(type) {
  if (type === 'custom') {
    document.getElementById('custom-wallpaper-input').click();
  } else {
    pendingWallpaper = type;
    previewWallpaper(type);
    $('#tab-wallpaper').show();
  }
  $('#body-rmenu').hide();
}

// Preview wallpaper in settings
function previewWallpaper(type) {
  pendingWallpaper = type;
  if (type === 'custom' && customWallpaperUrl) {
    document.getElementById('current-wallpaper-preview').style.backgroundImage = `url(${customWallpaperUrl})`;
  } else if (type !== 'custom') {
    document.getElementById('current-wallpaper-preview').style.backgroundImage = `url(${wallpapers[type]}?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&h=300&q=80)`;
  }
}

// Open custom wallpaper dialog
function openCustomWallpaper() {
  document.getElementById('custom-wallpaper-input').click();
}

// Handle custom wallpaper selection
document.getElementById('custom-wallpaper-input').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(event) {
      customWallpaperUrl = event.target.result;
      pendingWallpaper = 'custom';
      document.getElementById('current-wallpaper-preview').style.backgroundImage = `url(${customWallpaperUrl})`;
    };
    reader.readAsDataURL(file);
  }
});

// Apply wallpaper changes
function applyWallpaper() {
  if (!pendingWallpaper) return;
  
  const scaleMode = document.getElementById('wallpaper-scale').value;
  
  if (pendingWallpaper === 'custom' && customWallpaperUrl) {
    document.body.style.backgroundImage = `url(${customWallpaperUrl})`;
    localStorage.setItem('linuxWallpaper', 'custom:' + customWallpaperUrl);
    currentWallpaper = 'custom:' + customWallpaperUrl;
  } else if (pendingWallpaper !== 'custom') {
    document.body.style.backgroundImage = `url(${wallpapers[pendingWallpaper]}?ixlib=rb-1.2.1&auto=format&fit=crop&w=${window.screen.width}&h=${window.screen.height}&q=80)`;
    localStorage.setItem('linuxWallpaper', pendingWallpaper);
    currentWallpaper = pendingWallpaper;
  }
  
  document.body.style.backgroundSize = scaleMode;
  localStorage.setItem('wallpaperScale', scaleMode);
  
  updateWallpaperPreview();
  $('#tab-wallpaper').hide();
}

// Update preview in settings
function updateWallpaperPreview() {
  if (currentWallpaper.startsWith('custom:')) {
    document.getElementById('current-wallpaper-preview').style.backgroundImage = `url(${currentWallpaper.replace('custom:', '')})`;
  } else {
    document.getElementById('current-wallpaper-preview').style.backgroundImage = `url(${wallpapers[currentWallpaper]}?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&h=300&q=80)`;
  }
}

// Open wallpaper settings
function openWallpaperSettings() {
  $('#tab-wallpaper').show();
  pendingWallpaper = currentWallpaper.startsWith('custom:') ? 'custom' : currentWallpaper;
  updateWallpaperPreview();
  $('#body-rmenu').hide();
}

// Initialize on load
$(document).ready(function() {
  initWallpaper();
});

// Hide menus initially
$('#body-rmenu').hide();
$('#appMenu').hide();
</script>

</body>
</html>